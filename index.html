<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHRONOS_V35_PULSE</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { --glow: #00ff41; --bg: #000; }
        body, html { margin:0; padding:0; background: var(--bg); color:var(--glow); font-family:'Rajdhani',sans-serif; width:100vw; height:100vh; overflow:hidden; }
        
        /* Reactive Background */
        #nebula-canvas { position: fixed; top:0; left:0; z-index: 1; filter: blur(2px); transition: 0.5s; }
        
        /* The Pulse Animation */
        @keyframes pulseGlow {
            0% { text-shadow: 0 0 20px var(--glow); transform: scale(1); }
            50% { text-shadow: 0 0 80px var(--glow), 0 0 120px #fff; transform: scale(1.02); }
            100% { text-shadow: 0 0 20px var(--glow); transform: scale(1); }
        }
        .sync-active #timer-display { animation: pulseGlow 2s infinite ease-in-out; }

        /* Sparkling Stars */
        .star { position: absolute; background: white; border-radius: 50%; opacity: 0.5; z-index: 2; }
        
        #menu-trigger {
            position: fixed; top: 25px; left: 25px; z-index: 10001;
            background: #000; border: 2px solid var(--glow); color: var(--glow);
            padding: 12px 25px; font-family: 'Orbitron'; font-weight: 900;
            cursor: pointer; display: none;
        }

        #side-panel {
            width: 420px; position: fixed; left: -450px; top: 0; bottom: 0;
            background: rgba(0, 5, 0, 0.9); border-right: 2px solid var(--glow);
            display: flex; flex-direction: column; padding: 90px 25px 25px 25px;
            z-index: 10000; backdrop-filter: blur(15px); transition: 0.5s;
        }

        #timer-display { font-family: 'Orbitron'; font-size: 14rem; font-weight: 900; z-index: 5; position: relative; pointer-events: none; }
        
        .visualizer-bar { position: fixed; bottom: 0; background: var(--glow); width: 4px; z-index: 2; opacity: 0.3; transition: height 0.1s; }
    </style>
</head>
<body class="sync-active">
    <canvas id="nebula-canvas"></canvas>
    <div id="star-field"></div>
    <div id="vis-container"></div>
    
    <audio id="bg-audio" crossorigin="anonymous" loop></audio>
    <button id="menu-trigger" onclick="toggleMenu()">â˜° HUD_COMMAND</button>

    <div id="boot-screen" style="position:fixed; width:100%; height:100%; background:#000; z-index:99999; display:flex; align-items:center; justify-content:center; flex-direction:column; border: 10px solid var(--glow);">
        <h1 style="font-family:'Orbitron'; font-size:4rem; letter-spacing:15px;">NEURAL_PULSE</h1>
        <button onclick="startSystem()" style="width:300px; padding:20px; background:var(--glow); border:none; font-family:'Orbitron'; font-weight:900; cursor:pointer; margin-top:20px;">INITIALIZE_SYNC</button>
    </div>

    <div id="main-container" style="display:none; width:100vw; height:100vh; position:relative; z-index:10; display:flex; align-items:center; justify-content:center;">
        <div id="side-panel">
             <h3 style="font-family:'Orbitron'; font-size:0.7rem;">LOGBOOK</h3>
             <textarea id="manual-log" style="width:100%; height:200px; background:transparent; color:#fff; border:1px solid var(--glow);" oninput="saveLocal()"></textarea>
             <button onclick="location.reload()" style="margin-top:auto; color:red; border:1px solid red; background:transparent; padding:10px;">EXIT_STATION</button>
        </div>

        <div id="timer-zone" style="text-align:center;">
            <div id="timer-display">25:00</div>
            <button id="timer-btn" onclick="timerControl()" style="width:300px; height:60px; background:var(--glow); border:none; font-family:'Orbitron'; font-weight:900; cursor:pointer;">ENGAGE_WARP</button>
        </div>
    </div>

    <script>
        let rTime = 25 * 60; let running = false;
        let data = JSON.parse(localStorage.getItem('p_data_v32')) || { sessions: 0, minutes: 0, log: "" };

        // --- VISUALIZER ENGINE ---
        const canvas = document.getElementById('nebula-canvas');
        const ctx = canvas.getContext('2d');
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();

        function startSystem() {
            document.getElementById('boot-screen').style.display = 'none';
            document.getElementById('main-container').style.display = 'flex';
            document.getElementById('menu-trigger').style.display = 'block';
            const audio = document.getElementById('bg-audio');
            audio.src = "https://stream.nightride.fm/nightride.mp3";
            audio.play();
            renderNebula();
            createVis();
            refreshUI();
        }

        function createVis() {
            const container = document.getElementById('vis-container');
            for(let i=0; i<60; i++) {
                let bar = document.createElement('div');
                bar.className = 'visualizer-bar';
                bar.style.left = (i * 1.7) + 'vw';
                container.appendChild(bar);
            }
            animateVis();
        }

        function animateVis() {
            const bars = document.querySelectorAll('.visualizer-bar');
            bars.forEach(bar => {
                let h = Math.random() * 40; // Simulated audio data
                bar.style.height = h + 'vh';
            });
            setTimeout(animateVis, 150);
        }

        function renderNebula() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            let time = Date.now() * 0.001;
            for(let i=0; i<5; i++) {
                let x = canvas.width/2 + Math.sin(time + i) * 100;
                let y = canvas.height/2 + Math.cos(time * 0.5 + i) * 100;
                let grad = ctx.createRadialGradient(x, y, 0, x, y, 400);
                grad.addColorStop(0, 'rgba(0, 255, 65, 0.05)');
                grad.addColorStop(1, 'transparent');
                ctx.fillStyle = grad;
                ctx.fillRect(0,0,canvas.width, canvas.height);
            }
            requestAnimationFrame(renderNebula);
        }

        function timerControl() {
            running = !running;
            document.getElementById('timer-btn').innerText = running ? "HOLD" : "RESUME";
            if(running) tick();
        }

        function tick() {
            if(!running) return;
            if(rTime > 0) {
                rTime--;
                const m = Math.floor(rTime / 60).toString().padStart(2, '0');
                const s = (rTime % 60).toString().padStart(2, '0');
                document.getElementById('timer-display').innerText = `${m}:${s}`;
                setTimeout(tick, 1000);
            }
        }
        
        function refreshUI() { document.getElementById('manual-log').value = data.log || ""; }
        function saveLocal() { data.log = document.getElementById('manual-log').value; localStorage.setItem('p_data_v32', JSON.stringify(data)); }
        function toggleMenu() { let p = document.getElementById('side-panel'); p.style.left = p.style.left === "0px" ? "-450px" : "0px"; }
    </script>
</body>
</html>
